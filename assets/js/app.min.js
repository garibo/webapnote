$(document).ready(function(){$.fn.reset=function(){$(this).each(function(){this.reset()})},$("#rfc-input").limitar({limite:13,id_counter:"counter",clase_alert:"alert"}),$("#user-inputname").limitar({limite:10,id_counter:"counter",clase_alert:"alert"}),$("#addUsuario").submit(function(e){e.preventDefault(),$.post("welcome/registrarUsuario",$(this).serialize(),function(e){1==e?($("#addUsuario").animate({opacity:"0",display:"none"},500),$("#app-policy").animate({opacity:"0",display:"none"},500),$("#app-success-msg").delay(300).animate({opacity:"1",display:"inherit","z-index":"9999"},500).delay(2e3),$("#register-modal").delay(5e3).foundation("reveal","close"),$("#addUsuario").reset(),$("#app-success-msg").delay(5e3).animate({opacity:"0",display:"none","z-index":"0"},500),$("#addUsuario").delay(5e3).animate({opacity:"1",display:"inherit"},500),$("#app-policy").delay(5e3).animate({opacity:"1",display:"inherit"},500)):($(".app-error-data").html(e),$("#addUsuario").animate({opacity:"0",display:"none"},500),$("#app-policy").animate({opacity:"0",display:"none"},500),$("#app-error-msg").delay(300).animate({opacity:"1",display:"inherit","z-index":"9999"},500))})}),$(".close-error-msg").click(function(){$("#app-error-msg").animate({opacity:"0",display:"none"},500).css("z-index","0"),$("#addUsuario").delay(500).animate({opacity:"1",display:"inherit"},500),$("#app-policy").animate({opacity:"1",display:"inherit"},500)}),$("#app-signin").submit(function(e){e.preventDefault(),$.post("welcome/addLogin",$(this).serialize(),function(e){1==e?location.href="dashboard":setTimeout(function(){var e=new NotificationFx({message:'<p style="font-size: 14px;">El Correo eletronico y/o Contraseña son incorrectos.</p>',layout:"growl",effect:"jelly",type:"notice"});e.show()},100)})}),$("html").click(function(){$(".app-icon-widget").removeClass("app-icon-widget-base"),$(".app-icon-comment").removeClass("app-icon-widget-base")}),$("#add-form-org").submit(function(e){e.preventDefault();var o;$.ajax({type:"POST",url:"organizaciones/addO",data:$(this).serialize(),dataType:"json",success:function(e){o=0,console.log(e);for(var a=0;a<e.length;a++)""===e[a].error?$("#"+e[a].campo+" .span-error").html("").removeClass("show").addClass("hide"):($("#"+e[a].campo+" .span-error").html(e[a].error).removeClass("hide").addClass("show"),o+=1);console.log(o),0===o&&($("#app-add-org").foundation("reveal","close"),$("#add-form-org").reset(),alert("Registro Correcto"),location.href="organizaciones")}})}),$(".close-error-msg-org").click(function(){$("#app-error-msg-org").animate({opacity:"0",display:"none"},500).css("z-index","0"),$("#add-form-org").delay(500).animate({opacity:"1",display:"inherit"},500),$(".error-title").animate({opacity:"1",display:"inherit"},500)}),$("#reg-user-t").click(function(){$("#add-user-te").slideToggle("slow")}),$("#cancel-team").click(function(){$("#add-user-te").slideToggle("slow")}),$("#org-options").change(function(){var e="",o="";$("#org-options option:selected").each(function(){e+=$(this).val()+"",0===e?console.log(e):(o="/proyectos/selected/"+e,location.href=o)})}),$("#btn-open-pro").click(function(){$("#panel-form-id").slideToggle("slow")}),$("#phone-edit").validations("0123456789"),$("#phone-input").validations("0123456789"),$("a#del").click(function(e){var o=$(this).attr("value");$.ajax({url:"organizaciones/delete/"+o,dataType:"text",success:function(e){1==e?location.href="organizaciones":setTimeout(function(){var e=new NotificationFx({message:'<p style="font-size: 14px;">La organización contiene Usuarios o Proyectos registrados. No se puede eliminar la organización.</p>',layout:"growl",effect:"slide",type:"notice"});e.show()},100)}}),e.preventDefault()}),$("#add-team-user").submit(function(e){e.preventDefault();var o,a=$(this).attr("value");$.ajax({type:"POST",url:"/organizaciones/updateUsers/"+a,data:$(this).serialize(),dataType:"json",success:function(e){o=0,console.log(e);for(var t=0;t<e.length;t++)""===e[t].error?$("#"+e[t].campo+" .span-error").html("").removeClass("show").addClass("hide"):($("#"+e[t].campo+" .span-error").html(e[t].error).removeClass("hide").addClass("show"),o+=1);0===o&&($("#add-user-te").slideToggle("slow"),$("#add-team-user").reset(),setTimeout(function(){var e=new NotificationFx({message:'<p style="font-size: 14px;">Nuevo usuario agregado al equipo de trabajo.</p>',layout:"growl",effect:"slide",type:"notice",onClose:function(){setTimeout(function(){location.href="/organizaciones/team/"+a},200)}});e.show()},100))}})}),$("#th-profile").mouseenter(function(){$("#th-profile a").fadeIn(250)}).mouseleave(function(){$("#th-profile a").fadeOut(250)});var e=0;$("#edit-profile").click(function(){0===e?($(".group-profile-info input").removeAttr("disabled"),$(this).html('<i class="fi-x" style="position: absolute; top: 5px; left: 10px; font-size: 20px;"></i>  Cancelar'),$("#save-profile").fadeIn(200),e++):($(".group-profile-info input").prop("disabled",!0),$(this).html('<i class="fi-page-edit" style="position: absolute; top: 5px; left: 25px; font-size: 20px;"></i> Editar'),$("#save-profile").fadeOut(200),setTimeout(function(){location.href="profile"},200),e=0)}),$("#save-profile").click(function(e){e.preventDefault();var o;$.ajax({type:"POST",url:"/profile/actualizar",data:$("#sv-profile").serialize(),dataType:"json",success:function(e){o=0,console.log(e);for(var a=0;a<e.length;a++)""===e[a].error?$("#"+e[a].campo+" .span-error").html("").removeClass("show").addClass("hide"):($("#"+e[a].campo+" .span-error").html(e[a].error).removeClass("hide").addClass("show"),o+=1);0===o&&setTimeout(function(){var e=new NotificationFx({message:'<p style="font-size: 14px;">Cambios realizados correctamente. Espere un momento, se volvera a cargar la pagina.</p>',layout:"growl",effect:"slide",type:"notice",onClose:function(){setTimeout(function(){location.href="profile"},200)}});e.show()},100)}})}),$("#add-category").submit(function(e){e.preventDefault(),$.ajax({type:"POST",url:"/profile/category",data:$(this).serialize(),dataType:"json",success:function(e){$("#dynitem").before('<button class="button radius small disabled" id="procat">'+e.nombre+"</button>"),$("#addcategory").foundation("reveal","close"),setTimeout(function(){var e=new NotificationFx({message:'<p style="font-size: 14px;">Cambios realizados correctamente. Espere un momento, se volvera a cargar la pagina.</p>',layout:"growl",effect:"slide",type:"notice",onClose:function(){setTimeout(function(){location.href="profile"},200)}});e.show()},100)}})}),$("#uploadfile").on("click",function(e){e.preventDefault(),$("#userfile").click()}),$("input[type=file]").change(function(){this.files[0].name.toString();var e=new FileReader;e.onload=function(e){$("#preview").attr("src",e.target.result)},e.readAsDataURL(this.files[0]),$("#save-pp").fadeIn()}),$("#cat").change(function(e){e.preventDefault();var o=document.getElementById("agregarProy"),a=o.getAttribute("data-company"),t="";$("#new .newop").remove(),$("#cat option:selected").each(function(){t=$(this).val(),$.ajax({url:"/proyectos/obtenerResponsables/"+t+"/"+a,dataType:"json",success:function(e){console.log(e);for(var o=0;o<e.length;o++)$("#new").append('<option class="newop" value="'+e[o].u_email+'">'+e[o].u_nombre+" "+e[o].u_apep+" "+e[o].u_apem+"</option>")}})})}),$("#agregarProy").submit(function(e){var o,a=document.getElementById("agregarProy"),t=a.getAttribute("data-company");e.preventDefault(),$.ajax({type:"POST",url:"/proyectos/agregarProyecto/"+t,data:$(this).serialize(),dataType:"json",success:function(e){o=0,console.log(e);for(var a=0;a<e.length;a++)""===e[a].error?$("#"+e[a].campo+" .span-error").html("").removeClass("show").addClass("hide"):($("#"+e[a].campo+" .span-error").html(e[a].error).removeClass("hide").addClass("show"),o+=1);0===o&&($("#panel-form-id").slideToggle("slow"),setTimeout(function(){var e=new NotificationFx({message:'<p style="font-size: 14px;">Cambios realizados correctamente. Espere un momento, se volvera a cargar la pagina.</p>',layout:"growl",effect:"slide",type:"notice",onClose:function(){setTimeout(function(){location.href="/proyectos/selected/"+t},200)}});e.show()},100))}})}),$("#new-category").submit(function(e){e.preventDefault(),$.ajax({type:"POST",url:"/proyectos/agregarCategoria",data:$(this).serialize(),dataType:"json",success:function(e){console.log(e),"1"==e.error?$("#"+e.campo+" .span-error").html(e.msg).addClass("show").removeClass("hide"):($("#"+e.campo+" span").addClass("hide").removeClass("show"),$("#add-user-te").slideToggle("slow"),setTimeout(function(){var e=new NotificationFx({message:'<p style="font-size: 14px;">Categoria agregada correctamente. Espere un momento.</p>',layout:"growl",effect:"slide",type:"notice",onClose:function(){setTimeout(function(){location.href="/proyectos/categorias/"},200)}});e.show()},100))}})})});