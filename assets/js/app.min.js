$(document).ready(function(){$.fn.reset=function(){$(this).each(function(){this.reset()})},$("#rfc-input").limitar({limite:13,id_counter:"counter",clase_alert:"alert"}),$("#user-inputname").limitar({limite:10,id_counter:"counter",clase_alert:"alert"}),$("#addUsuario").submit(function(e){e.preventDefault(),$.post("welcome/registrarUsuario",$(this).serialize(),function(e){1==e?($("#addUsuario").animate({opacity:"0",display:"none"},500),$("#app-policy").animate({opacity:"0",display:"none"},500),$("#app-success-msg").delay(300).animate({opacity:"1",display:"inherit","z-index":"9999"},500).delay(2e3),$("#register-modal").delay(5e3).foundation("reveal","close"),$("#addUsuario").reset(),$("#app-success-msg").delay(5e3).animate({opacity:"0",display:"none","z-index":"0"},500),$("#addUsuario").delay(5e3).animate({opacity:"1",display:"inherit"},500),$("#app-policy").delay(5e3).animate({opacity:"1",display:"inherit"},500)):($(".app-error-data").html(e),$("#addUsuario").animate({opacity:"0",display:"none"},500),$("#app-policy").animate({opacity:"0",display:"none"},500),$("#app-error-msg").delay(300).animate({opacity:"1",display:"inherit","z-index":"9999"},500))})}),$(".close-error-msg").click(function(){$("#app-error-msg").animate({opacity:"0",display:"none"},500).css("z-index","0"),$("#addUsuario").delay(500).animate({opacity:"1",display:"inherit"},500),$("#app-policy").animate({opacity:"1",display:"inherit"},500)}),$("#app-signin").submit(function(e){e.preventDefault(),$.post("welcome/addLogin",$(this).serialize(),function(e){1==e?location.href="dashboard":swal("Error","Correo Electr칩nico y/o Contrase침a incorrectos","error")})}),$("html").click(function(){$(".app-icon-widget").removeClass("app-icon-widget-base"),$(".app-icon-comment").removeClass("app-icon-widget-base")}),$("#add-form-org").submit(function(e){e.preventDefault();var a;$.ajax({type:"POST",url:"organizaciones/addO",data:$(this).serialize(),dataType:"json",success:function(e){a=0,console.log(e);for(var o=0;o<e.length;o++)""===e[o].error?$("#"+e[o].campo+" .span-error").html("").removeClass("show").addClass("hide"):($("#"+e[o].campo+" .span-error").html(e[o].error).removeClass("hide").addClass("show"),a+=1);console.log(a),0===a&&($("#app-add-org").foundation("reveal","close"),$("#add-form-org").reset(),alert("Registro Correcto"),location.href="organizaciones")}})}),$(".close-error-msg-org").click(function(){$("#app-error-msg-org").animate({opacity:"0",display:"none"},500).css("z-index","0"),$("#add-form-org").delay(500).animate({opacity:"1",display:"inherit"},500),$(".error-title").animate({opacity:"1",display:"inherit"},500)}),$("#reg-user-t").click(function(){$("#add-user-te").slideToggle("slow")}),$("#cancel-team").click(function(){$("#add-user-te").slideToggle("slow")}),$("#org-options").change(function(){var e="",a="";$("#org-options option:selected").each(function(){e+=$(this).val()+"",0===e?console.log(e):(a="/proyectos/selected/"+e,location.href=a)})}),$("#btn-open-pro").click(function(){$("#panel-form-id").slideToggle("slow")}),$("#phone-edit").validations("0123456789"),$("#phone-input").validations("0123456789"),$("a#del").click(function(e){var a=$(this).attr("value");swal({title:"Estas seguro?",text:"Una vez eliminado, ya no podr치s recuperarlo.",type:"warning",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"Si, Eliminar",cancelButtonText:"Cancelar",closeOnConfirm:!1},function(){$.ajax({url:"organizaciones/delete/"+a,dataType:"text",success:function(e){1==e?location.href="organizaciones":swal("Error","No se puede eliminar la organizaci칩n","error")}})}),e.preventDefault()}),$("#add-team-user").submit(function(e){e.preventDefault();var a,o=$(this).attr("value");$.ajax({type:"POST",url:"/organizaciones/updateUsers/"+o,data:$(this).serialize(),dataType:"json",success:function(e){a=0,console.log(e);for(var o=0;o<e.length;o++)""===e[o].error?$("#"+e[o].campo+" .span-error").html("").removeClass("show").addClass("hide"):($("#"+e[o].campo+" .span-error").html(e[o].error).removeClass("hide").addClass("show"),a+=1);if(0===a){$("#add-user-te").slideToggle("slow"),$("#add-team-user").reset();var t=$("<tr/>");$.each(e[0].datos,function(e,a){$("<td/>",{text:a}).appendTo(t)}),$("<td/>",{html:'<a href="/organizaciones/deleteTUser/'+e[0].datos.ausername+"/"+e[0].rfc+'" class="btn-delete"><i class="fi-trash"></i></a><a href="/organizaciones/profileTeam/'+e[0].datos.ausername+'"data-reveal-id="modal-demo" data-reveal-ajax="true"><i class="fi-torso"></i></a>'}).css("text-align","center").css("font-size","20px").appendTo(t),t.appendTo("#records-organizaciones"),swal("Good Job!","Usuario agregado correctamente","success")}}})}),$("#th-profile").mouseenter(function(){$("#th-profile a").fadeIn(250)}).mouseleave(function(){$("#th-profile a").fadeOut(250)});var e=0;$("#edit-profile").click(function(){0===e?($(".group-profile-info input").removeAttr("disabled"),$(this).html('<i class="fi-x" style="position: absolute; top: 5px; left: 10px; font-size: 20px;"></i>  Cancelar'),$("#save-profile").fadeIn(200),e++):($(".group-profile-info input").prop("disabled",!0),$(this).html('<i class="fi-page-edit" style="position: absolute; top: 5px; left: 25px; font-size: 20px;"></i> Editar'),$("#save-profile").fadeOut(200),setTimeout(function(){location.href="profile"},200),e=0)}),$("#save-profile").click(function(e){e.preventDefault();var a;$.ajax({type:"POST",url:"/profile/actualizar",data:$("#sv-profile").serialize(),dataType:"json",success:function(e){a=0,console.log(e);for(var o=0;o<e.length;o++)""===e[o].error?$("#"+e[o].campo+" .span-error").html("").removeClass("show").addClass("hide"):($("#"+e[o].campo+" .span-error").html(e[o].error).removeClass("hide").addClass("show"),a+=1);0===a&&setTimeout(function(){var e=new NotificationFx({message:'<p style="font-size: 14px;">Cambios realizados correctamente. Espere un momento, se volvera a cargar la pagina.</p>',layout:"growl",effect:"slide",type:"notice",onClose:function(){setTimeout(function(){location.href="profile"},200)}});e.show()},100)}})}),$("#add-category").submit(function(e){e.preventDefault(),$.ajax({type:"POST",url:"/profile/category",data:$(this).serialize(),dataType:"json",success:function(e){$("#dynitem").before('<button class="button radius small disabled" id="procat">'+e.nombre+"</button>"),$("#addcategory").foundation("reveal","close"),setTimeout(function(){var e=new NotificationFx({message:'<p style="font-size: 14px;">Cambios realizados correctamente. Espere un momento, se volvera a cargar la pagina.</p>',layout:"growl",effect:"slide",type:"notice",onClose:function(){setTimeout(function(){location.href="profile"},200)}});e.show()},100)}})}),$("#uploadfile").on("click",function(e){e.preventDefault(),$("#userfile").click()}),$("input[type=file]").change(function(){this.files[0].name.toString();var e=new FileReader;e.onload=function(e){$("#preview").attr("src",e.target.result)},e.readAsDataURL(this.files[0]),$("#save-pp").fadeIn()}),$("#cat").change(function(e){e.preventDefault();var a=document.getElementById("agregarProy"),o=a.getAttribute("data-company"),t="";$("#new .newop").remove(),$("#cat option:selected").each(function(){t=$(this).val(),$.ajax({url:"/proyectos/obtenerResponsables/"+t+"/"+o,dataType:"json",success:function(e){console.log(e);for(var a=0;a<e.length;a++)$("#new").append('<option class="newop" value="'+e[a].u_email+'">'+e[a].u_nombre+" "+e[a].u_apep+" "+e[a].u_apem+"</option>")}})})}),$("#agregarProy").submit(function(e){var a,o=document.getElementById("agregarProy"),t=o.getAttribute("data-company");e.preventDefault(),$.ajax({type:"POST",url:"/proyectos/agregarProyecto/"+t,data:$(this).serialize(),dataType:"json",success:function(e){a=0,console.log(e);for(var o=0;o<e.length;o++)""===e[o].error?$("#"+e[o].campo+" .span-error").html("").removeClass("show").addClass("hide"):($("#"+e[o].campo+" .span-error").html(e[o].error).removeClass("hide").addClass("show"),a+=1);0===a&&($("#panel-form-id").slideToggle("slow"),setTimeout(function(){var e=new NotificationFx({message:'<p style="font-size: 14px;">Cambios realizados correctamente. Espere un momento, se volvera a cargar la pagina.</p>',layout:"growl",effect:"slide",type:"notice",onClose:function(){setTimeout(function(){location.href="/proyectos/selected/"+t},200)}});e.show()},100))}})}),$("#new-category").submit(function(e){e.preventDefault(),$.ajax({type:"POST",url:"/proyectos/agregarCategoria",data:$(this).serialize(),dataType:"json",success:function(e){console.log(e),"1"==e.error?$("#"+e.campo+" .span-error").html(e.msg).addClass("show").removeClass("hide"):($("#"+e.campo+" span").addClass("hide").removeClass("show"),$("#add-user-te").slideToggle("slow"),setTimeout(function(){var e=new NotificationFx({message:'<p style="font-size: 14px;">Categoria agregada correctamente. Espere un momento.</p>',layout:"growl",effect:"slide",type:"notice",onClose:function(){setTimeout(function(){location.href="/proyectos/categorias/"},200)}});e.show()},100))}})}),$("#form-activity").submit(function(e){e.preventDefault();var a=document.getElementById("form-activity"),o=a.getAttribute("data-id-proyecto"),t=$("#txt-task").val();console.log(o+" "+t),$.ajax({url:"/proyectos/agregarTarea",dataType:"json",type:"POST",data:{tarea:t,proyid:o},success:function(e){console.log(e)}})})});